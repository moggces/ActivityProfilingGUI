# Tox21 Activity Profiler


This interactive application allows users to browse activity profiles from the Tox21 dataset.  The activities of chemicals (based on CASRN) are presented. 

For a summary of data processing, see [this summary](https://www.dropbox.com/s/4ptkna93n3nel8v/pipeline_summary.pdf?dl=0). The underlying data are available for browsing in a related application, the [Tox21 curve browser](/sandbox/tox21-curve-visualization/).

## Quick start

Paste the following data-table into the "CAS & Cluster" text-box.

<table class='table table-condensed table-striped'>
<thead>
<tr>
  <th>CAS</th>
  <th>Cluster</th>
</tr>
</thead>
<tbody><tr>
  <td>83-79-4</td>
  <td>positive_zfish</td>
</tr>
<tr>
  <td>80-05-7</td>
  <td>negative_zfish</td>
</tr>
</tbody>
</table>

**Note**: paste the data AND the header column

***


### Required inputs

One of the two inputs below are required.

#### CAS & Cluster

A tab-delimited dataset (with header included). Two columns are allowed: chemicals and cluster. The cluster column is optional.

1. create one column (column name: CAS) or two columns of data (column names: CAS and Cluster) in Excel
  - CAS, chemical ID: one type is allowed, **CAS**
      - CAS: Chemical Abstracts Service registration ID, e.g., 83-79-4. Please put at least two CASRNs.
  - Cluster, chemical annotation: any annotation associated with the chemical that could be compared with the in vitro qHTS data
2. column names are case sensitive: **CAS** and **Cluster**
3. copy and paste to the text area

#### Data matrix

Alternatively, a data-matrix file can be uploaded.

1. the downloaded activity data can be modified and re-uploaded (e.g., add results from other external assays)
2. the file names have to contain **nwauc.logit|npod|nac50**. So it will recognize the type of activity and use the respective coloring scheme.
2. other data matrix with **CAS** as ID and comparable activity information can be uploaded (However, currently data from non-Tox21 chemicals will be excluded).
3. **Cluster** information is optional.
4. **input_Chemical.Name** can be used to change the column names in the heatmap (optional).

**Notes:**
- _Activity limiting_ and _Enrichment Analysis_ function become invalid.
- _Assay filtering_ function is still functional.

#### Activity type

* Profiling: Select from one of two profiling types:
  - signal: results observation, e.g., whether the compound causes increasing or decreasing signal
    + **signal type**: currently only wauc is available, suitable for compound grouping
  - activity: Results interpretation, e.g., whether the compound is active
    + An activity type can also be specified
    + **activity type**
      * wauc: overall effect of the chemical
      * pod: point-of-departure (depending on noise level in the assay)
      * ac50: half-maximal effect concentration

<table class='table table-condensed table-striped'>
<thead>
<tr>
  <th>Type</th>
  <th>Value range</th>
  <th>Value description</th>
</tr>
</thead>
<tbody><tr>
  <td>wauc</td>
  <td>0 ~ 1</td>
  <td>higher value -&gt; higher activity <br> 0 -&gt; inactive <br> 1E-4 -&gt; inconclusive</td>
</tr>
<tr>
  <td>pod</td>
  <td>log10(M)*(-1)</td>
  <td>higher value -&gt; more potent <br> 1E-4 -&gt; inconclusive <br> 0 -&gt; inactive</td>
</tr>
</tbody>
</table>

ac50 type is same as pod type.

***
### Other settings

#### Limit activities
The default activity results are based on Curvep-wAUC pipeline (i.e. activities from known assay interferences are flagged and labeled as **inconclusive**). But the activities can be **further** limited by following parameters and labeled as **inconclusive**.

* wAUC threshold: see above
* Emax threshold: half-maximal effect concentration (e.g., 30% relative to the positive control)
* POD threshold: (uM)
* AC50 threshold: (uM)
* log10(ratio of signal to cytotoxicity) (for inhibition-type assays): (e.g., 1 => 10 fold between signal and cytotoxicity).
* exclude activity due to cytotoxicity (loose): the default setting in pipeline (see summary file)
* exclude activity due to cytotoxicity (strict): toggle ON to exclude any activity with cytotoxicity (information from the respective multiplexed assay) seen in the tested concentration range.(For nuclear receptor antagonism assays & aromatase inhibition assay only) 
* exclude activity with suboptimal NCATS fits: toggle ON to exclude activities NOT having curve class (NCATS method) 1.1, 1.2, 2.1 in at least one run
* exclude activity varied between sources: toggle OFF to include more potential activity. The included activities can still be recognized in the heatmap by the # sign


***

#### Filter assays

Please see the __Assays__ tab to get complete assay (column name: common_name) information

Simple regular expression rules:

1. how to get all specific assays
    + put _cytotoxicity_ in the text box plus toggle _ON_ invert your selection
2. how to get all antagonism or inhibition and specific assays
    + put antagonism\_|inhibition\_ in the text box plus toggle _OFF_ invert your selection (Note: _|_ means _OR_)
3. how to get all agonism and specific assays
    + put \\bagonism\_ in the text box plus toggle _OFF_ invert your selection

***

#### Sort chemicals
The columns of the heatmap can be ordered in three methods:

1. structure similarity
    + Tanimoto coefficient based on Leadscope proprietary structural fingerprints
    + hierarchical clustering with average linkage
    + chemicals are grouped by cutoff 0.7
    + a new parameter is created, chemClust, where chemClust = 0, are the compounds that cannot form clusters or compounds without structures

2. activity similarity
    + Euclidean distance based on respective activities
    + hierarchical clustering with average linkage

3. toxicity score (only for __activity__)
    + sum of the activities (unbounded, dependent on # of assays used)
        + wauc: sum of wauc values
        + pod or ac50: sum of wauc-weighted pod or ac50 values (in data matrix input, sum of pod/ac50 values instead)

***

### Formatting & outputs

1. make inconclusive as inactive: ON makes all inconclusive (value = 1E-4) as inactives (value = 0)
2. show compound similarity dendrogram: the clustered dendrogram will replace the the heatmap
3. keep heatmap size one page
4. adjust font size when downloading heatmap or online

  * Download Activities
  * Save Plot (currently only for heatmap)
  * Download Enrichment analysis

***

### Tabs

#### Input chemicals

If the input chemicals are not available, they will not have _GSID_.
Current information is based on EPA DSSTOX.

#### Profile

The heatmap will be displayed here.

##### Main map

* columns are compounds
* rows are assays
* cells are activities
* coloring scheme: please refer the color bar
* gray color: not tested. However if "exclude inconclusive label" ON, it could also mean _inconclusive_.

##### annotation map

* columns are compounds
* first row is toxScore (only available in __activity__)
* second row is userClust (__Cluster__)
* third row is chemCust

#### Potency plot

Only shown for pod or ac50 as activity.

#### Activity data

background data used for heatmap and potency plot

#### Enrichment analysis

* DAVID (more stringent) Fisher's exact test is applied
* n: number of compounds in a class; n\_p: number of actives in a class; N\_P: number of actives in the population;n: number of compounds in the population


#### Assays

assay information

### Troubleshooting

* Error: 'breaks' are not unique. It is possible that the input compounds are not active in any of the assays. Please add another compound (e.g. 80-05-7).
* The compound is missing on the heatmap. The compound may not be tested or none of its sources passes the chemical QC.

***

### Release notes

*v1.1*

* initial public release

*v1.2*

* new: enrichment panel is added; results can be downloaded
* changed: purity information fixed(v5a5) v030716
* changed: add PubChem AIDs for the lately released assays in PubChem
* changed: default was set to activity clustering (columns)
* changed: structural clustering fixed for missing Tox21 chemicals due to low purity

***

### Contact

For further information, contact:

Jui-Hua Hsieh, Ph.D.
[Biomolecular Screening Branch](http://www.niehs.nih.gov/research/atniehs/labs/bmsb/toxico/staff/hsieh/index.cfm)
